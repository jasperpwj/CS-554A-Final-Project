{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/lirupu/cs-554-web2/CS-554A-Final-Project/client/src/components/SongPlay.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport playAction from '../actions/playAction';\nimport { withRouter } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core';\nimport FastForwardIcon from '@material-ui/icons/FastForward';\nimport FastRewindIcon from '@material-ui/icons/FastRewind';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport { deprecationHandler } from \"moment\";\nconst useStyles = makeStyles({\n  song_details: {\n    position: 'absolute',\n    left: '20px',\n    lineHeight: '22px'\n  },\n  song_name: {\n    fontFamily: '\"Proxima Nova\" Georgia sans-serif',\n    color: '#fff',\n    fontSize: '14px'\n  },\n  artist_name: {\n    fontFamily: '\"Proxima Nova\" Georgia sans-serif',\n    color: '#aaa',\n    fontSize: '12px'\n  },\n  progress_container: {\n    position: 'relative',\n    top: '-7px',\n    fontSize: '40px',\n    margin: '0 5px',\n    marginTop: '10px',\n    display: 'flex',\n    justifyContent: 'center'\n  },\n  progress: {\n    width: '500px',\n    height: '4px',\n    background: 'rgb(64, 64, 64)',\n    borderRadius: '4px'\n  },\n  footer: {\n    position: 'fixed',\n    width: '100%',\n    bottom: 0,\n    left: 0,\n    background: 'rgb(40, 40, 40)',\n    height: '80px',\n    zIndex: 2\n  },\n  song_controls: {\n    justifyContent: 'center',\n    display: 'flex',\n    marginTop: '20px'\n  },\n  play_btn: {\n    padding: \"0 5px\",\n    color: 'rgb(179, 179, 179)',\n    cursor: 'pointer'\n  },\n  last_song: {\n    padding: \"0 5px\",\n    color: 'rgb(179, 179, 179)',\n    cursor: 'pointer'\n  },\n  next_song: {\n    padding: \"0 5px\",\n    color: 'rgb(179, 179, 179)',\n    cursor: 'pointer'\n  }\n});\n\nconst SongPlay = props => {\n  _s();\n\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const [audio, setAudio] = useState(undefined);\n  const allState = useSelector(state => state);\n  const songsPlay = allState.songsPlay;\n  const song = allState.songsPlay.song;\n  const songList = allState.songsPlay.songList;\n  const index = allState.songsPlay.currentIndex;\n  const [currentPlay, setCurrentPlay] = useState(songsPlay.globalPlay);\n  const [changeProgress, setChangeProgress] = useState(undefined);\n\n  const stopSong = () => {\n    if (audio) {\n      //this.props.stopSong();\n      audio.pause();\n    }\n  };\n\n  const pauseSong = () => {\n    if (audio) {\n      //this.props.pauseSong();\n      audio.pause();\n    }\n  };\n\n  const resumeSong = () => {\n    if (audio) {\n      //this.props.resumeSong();\n      audio.play();\n    }\n  };\n\n  const audioControl = (song, index) => {\n    console.log(song); //const { playSong, stopSong } = this.props;\n\n    if (audio === undefined) {\n      const audioplay = new Audio(song.track.preview_url);\n      console.log(audioplay);\n      setAudio(audioplay); //dispatch(playAction.updateIndex(index));\n\n      audioplay.play();\n    } else {\n      stopSong();\n      dispatch(playAction.stopSong());\n      dispatch(playAction.playSong(song, index)); //playSong(song.track);\n\n      const audioplay = new Audio(song.track.preview_url);\n      console.log(audioplay);\n      setAudio(audioplay); //dispatch(playAction.updateIndex(index));\n\n      audioplay.play();\n    }\n  };\n\n  const getSongIndex = () => {\n    const SongIndex = songList.map((everySong, index) => {\n      if (everySong.track.id === song.track.id) {\n        return index;\n      } else {\n        return undefined;\n      }\n    }).filter(item => {\n      return item !== undefined;\n    })[0];\n    return SongIndex;\n  };\n\n  const last = () => {\n    let SongIndex = getSongIndex();\n    setProgress(0);\n    SongIndex === 0 ? audioControl(songList[songList.length - 1]) : audioControl(songList[SongIndex - 1]);\n  };\n\n  const next = () => {\n    let SongIndex = getSongIndex();\n    setProgress(0);\n    SongIndex === songList.length - 1 ? audioControl(songList[0]) : audioControl(songList[SongIndex + 1]);\n  };\n\n  const handleChange = song => {\n    if (songsPlay.globalPlay) {\n      dispatch(playAction.pauseSong());\n      console.log(\"ee\");\n      pauseSong();\n    } else {\n      dispatch(playAction.resumeSong());\n      resumeSong(); //audioControl(song);\n    }\n  };\n\n  const MAX = 30;\n  const MIN = 0;\n\n  const normalise = value => (value - MIN) * 100 / (MAX - MIN);\n\n  const [progress, setProgress] = React.useState(0);\n  useEffect(() => {\n    if (songsPlay.globalPlay) {\n      setProgress(0);\n      const timer = setInterval(() => {\n        var time = 0;\n        setProgress(oldProgress => {\n          if (oldProgress === 30) {\n            dispatch(playAction.pauseSong());\n            clearInterval(timer);\n            return 0;\n          }\n\n          const diff = 1;\n          time += oldProgress;\n          return Math.min(oldProgress + diff, 30);\n        });\n      }, 1000);\n      return () => {\n        clearInterval(timer);\n      };\n    }\n  }, [song, songsPlay.globalPlay]);\n  useEffect(() => {\n    if (songsPlay.globalPlay) {\n      audioControl(song);\n    } else {\n      pauseSong();\n    }\n  }, [songsPlay.globalPlay, song]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.footer,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.song_details,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: classes.song_name,\n        children: song ? song.track.name : ''\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: classes.artist_name,\n        children: song ? song.track.artists[0].name : ''\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.song_controls,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => last(),\n        className: classes.last_song,\n        children: /*#__PURE__*/_jsxDEV(FastRewindIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 22\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.play_btn,\n        onClick: () => handleChange(song),\n        children: songsPlay.globalPlay ? /*#__PURE__*/_jsxDEV(PauseIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 44\n        }, this) : /*#__PURE__*/_jsxDEV(PlayArrowIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 57\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: () => next(),\n        className: classes.next_song,\n        children: /*#__PURE__*/_jsxDEV(FastForwardIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 22\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 16\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.progress_container,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.progress,\n        children: /*#__PURE__*/_jsxDEV(LinearProgress, {\n          variant: \"determinate\",\n          value: normalise(progress)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 24\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 11\n  }, this);\n};\n\n_s(SongPlay, \"5+m87Ts2EllNvsSeT1+v63gdBuk=\", false, function () {\n  return [useDispatch, useStyles, useSelector];\n});\n\n_c = SongPlay;\nexport default _c2 = withRouter(SongPlay);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SongPlay\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/lirupu/cs-554-web2/CS-554A-Final-Project/client/src/components/SongPlay.js"],"names":["React","useState","useEffect","useDispatch","useSelector","playAction","withRouter","makeStyles","FastForwardIcon","FastRewindIcon","PauseIcon","PlayArrowIcon","LinearProgress","deprecationHandler","useStyles","song_details","position","left","lineHeight","song_name","fontFamily","color","fontSize","artist_name","progress_container","top","margin","marginTop","display","justifyContent","progress","width","height","background","borderRadius","footer","bottom","zIndex","song_controls","play_btn","padding","cursor","last_song","next_song","SongPlay","props","dispatch","classes","audio","setAudio","undefined","allState","state","songsPlay","song","songList","index","currentIndex","currentPlay","setCurrentPlay","globalPlay","changeProgress","setChangeProgress","stopSong","pause","pauseSong","resumeSong","play","audioControl","console","log","audioplay","Audio","track","preview_url","playSong","getSongIndex","SongIndex","map","everySong","id","filter","item","last","setProgress","length","next","handleChange","MAX","MIN","normalise","value","timer","setInterval","time","oldProgress","clearInterval","diff","Math","min","name","artists"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport playAction from '../actions/playAction'\nimport {  withRouter } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core';\nimport FastForwardIcon from '@material-ui/icons/FastForward';\nimport FastRewindIcon from '@material-ui/icons/FastRewind';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport { deprecationHandler } from \"moment\";\n\nconst useStyles = makeStyles({\n    song_details :{\n        position: 'absolute',\n        left: '20px',\n        lineHeight: '22px',\n    },\n    song_name: {\n        fontFamily:'\"Proxima Nova\" Georgia sans-serif',\n        color: '#fff',\n        fontSize: '14px'\n    },\n    artist_name: {\n        fontFamily: '\"Proxima Nova\" Georgia sans-serif',\n        color: '#aaa',\n        fontSize: '12px'\n      },\n\n    progress_container:{\n        position: 'relative',\n        top: '-7px',\n        fontSize: '40px',\n        margin: '0 5px',\n        marginTop: '10px',\n        display: 'flex',\n        justifyContent: 'center'\n    },\n    progress : {\n        width: '500px',\n        height: '4px',\n        background: 'rgb(64, 64, 64)',\n        borderRadius: '4px'\n      },\n    footer :{\n        position: 'fixed',\n        width: '100%',\n        bottom: 0,\n        left: 0,\n        background: 'rgb(40, 40, 40)',\n        height: '80px',\n        zIndex: 2,\n    },\n    song_controls:{\n        justifyContent: 'center',\n        display: 'flex',\n        marginTop: '20px',\n    },\n    play_btn :{\n        padding: \"0 5px\",\n        color: 'rgb(179, 179, 179)',\n        cursor: 'pointer',\n    },\n    last_song:{\n        padding: \"0 5px\",\n        color: 'rgb(179, 179, 179)',\n        cursor: 'pointer',\n    },\n    next_song:{\n        padding: \"0 5px\",\n        color: 'rgb(179, 179, 179)',\n        cursor: 'pointer',\n    }\n\n});\n\nconst SongPlay = (props)=>{\n    const dispatch = useDispatch();\n    const  classes =  useStyles();\n    const [audio, setAudio] = useState(undefined);\n    const allState = useSelector((state) => state);\n    const songsPlay = allState.songsPlay;\n    const song = allState.songsPlay.song;\n    const songList = allState.songsPlay.songList;\n    const index = allState.songsPlay.currentIndex;\n    const [ currentPlay, setCurrentPlay] = useState(songsPlay.globalPlay);\n    const [ changeProgress, setChangeProgress] =  useState(undefined);\n\n    const stopSong = () => {\n        if (audio) {\n        //this.props.stopSong();\n        audio.pause();\n        }\n    };\n\n    const pauseSong = () => {\n        if (audio) {\n        //this.props.pauseSong();\n        audio.pause();\n        }\n    };\n\n    const resumeSong = () => {\n        if (audio) {\n        //this.props.resumeSong();\n        audio.play();\n\n        }\n    };\n\n\n    const audioControl = (song, index) => {\n        console.log(song);\n        //const { playSong, stopSong } = this.props;\n\n        if (audio === undefined) {\n            const audioplay = new Audio(song.track.preview_url);\n            console.log(audioplay);\n            setAudio(audioplay);\n            //dispatch(playAction.updateIndex(index));\n            audioplay.play();\n        } else {\n            stopSong();\n            dispatch(playAction.stopSong());\n            dispatch(playAction.playSong(song, index));\n            //playSong(song.track);\n            const audioplay = new Audio(song.track.preview_url);\n            console.log(audioplay);\n            setAudio(audioplay);\n            //dispatch(playAction.updateIndex(index));\n            audioplay.play();\n        }\n    };\n\n    const getSongIndex = () => {\n        const SongIndex = songList.map((everySong, index) => {\n          if (everySong.track.id === song.track.id) {\n            return index;\n          } else {\n            return undefined;\n          }\n        }).filter(item => {\n          return item !== undefined;\n        })[0];\n\n        return SongIndex;\n      }\n    const last =()=>{\n        let SongIndex = getSongIndex();\n        setProgress(0);\n        SongIndex === 0 ? audioControl(songList[songList.length - 1]) : audioControl(songList[SongIndex - 1]);\n\n    }\n    const next =()=>{\n        let SongIndex = getSongIndex();\n        setProgress(0);\n        SongIndex === songList.length - 1 ? audioControl(songList[0]) : audioControl(songList[SongIndex + 1]);\n\n    }\n\n    const handleChange = (song)=>{\n        if(songsPlay.globalPlay){\n            dispatch(playAction.pauseSong());\n            console.log(\"ee\");\n            pauseSong();\n        }else{\n            dispatch(playAction.resumeSong());\n            resumeSong();\n            //audioControl(song);\n        }\n    }\n    const MAX  = 30;\n    const MIN  =  0;\n    const normalise = value => (value - MIN) * 100 / (MAX - MIN);\n\n    const [progress, setProgress] = React.useState(0);\n\n    useEffect(() => {\n        if(songsPlay.globalPlay){\n            setProgress(0);\n            const timer = setInterval(() => {\n            var time =  0;\n            setProgress((oldProgress) => {\n                if (oldProgress === 30) {\n                    dispatch(playAction.pauseSong());\n                    clearInterval(timer);\n                return 0;\n\n                }\n                const diff = 1;\n                time += oldProgress\n                return Math.min(oldProgress + diff, 30);\n            });\n\n            }, 1000);\n\n\n        return () => {\n        clearInterval(timer);\n        };\n      }\n    }, [song, songsPlay.globalPlay]);\n    useEffect(() => {\n        if(songsPlay.globalPlay){\n            audioControl(song);\n        }else{\n            pauseSong();\n        }\n    }, [songsPlay.globalPlay, song]);\n\n    return(\n          <div className={classes.footer}>\n                <div className={classes.song_details}>\n                    <p className={classes.song_name}>{song?song.track.name:''}</p>\n                    <p className={classes.artist_name}>{song?song.track.artists[0].name:''}</p>\n               </div>\n               <div className={classes.song_controls}>\n\n                    <div onClick={()=>last()} className={classes.last_song}>\n                     <FastRewindIcon></FastRewindIcon>\n                    </div>\n\n                    <div className={classes.play_btn} onClick={()=>handleChange(song)}>\n                    {/* <i onClick={\"!this.props.songPaused ? this.props.pauseSong : this.props.resumeSong\"} className={\"showPlay\"} aria-hidden=\"true\" /> */}\n                    {songsPlay.globalPlay? <PauseIcon/>:<PlayArrowIcon></PlayArrowIcon>\n                    }\n                    </div>\n\n                    <div onClick={()=>next()} className={classes.next_song}>\n                     <FastForwardIcon></FastForwardIcon>\n                    </div>\n\n                </div>\n                <div className= {classes.progress_container}>\n                    <div className={classes.progress}>\n                       <LinearProgress variant=\"determinate\" value={normalise(progress)} />\n                    </div>\n                </div>\n\n          </div>\n      )\n\n}\n\nexport default withRouter(SongPlay);"]},"metadata":{},"sourceType":"module"}